# åŸºäº Scrapy çš„åˆ†å¸ƒå¼æ–°é—»æœç´¢å¼•æ“ ğŸ”ğŸ“°

ä¸€ä¸ªé›†æ•°æ®é‡‡é›†ã€å¤„ç†ã€ç´¢å¼•ã€æ£€ç´¢ä¸æ™ºèƒ½æ¨èäºä¸€ä½“çš„é«˜æ€§èƒ½æ–°é—»æœç´¢å¼•æ“ã€‚æœ¬é¡¹ç›®é€šè¿‡ Scrapy æ„å»ºåˆ†å¸ƒå¼å¼‚æ­¥çˆ¬è™«é›†ç¾¤ï¼Œé«˜æ•ˆé‡‡é›†ç½‘ç»œæ–°é—»ï¼ˆä¾‹å¦‚åšå®¢å›­ï¼‰ï¼Œåˆ©ç”¨ Elasticsearch æ„å»ºå¼ºå¤§çš„å€’æ’ç´¢å¼•åŠæ£€ç´¢å¼•æ“ï¼Œå¹¶é€šè¿‡ Django æ¡†æ¶æ­å»ºåŠŸèƒ½å®Œå–„ã€äº¤äº’å‹å¥½çš„å‰åç«¯åº”ç”¨ï¼Œå®ç°äº†äºšç§’çº§å…¨æ–‡æ£€ç´¢ã€æ™ºèƒ½æœç´¢å»ºè®®åŠçƒ­é—¨è¶‹åŠ¿åˆ†æã€‚


## ğŸŒŸ é¡¹ç›®æ¦‚è§ˆ

æœ¬é¡¹ç›®æ—¨åœ¨æ„å»ºä¸€ä¸ªä»æ•°æ®æŠ“å–åˆ°ç”¨æˆ·æ£€ç´¢çš„å…¨é“¾è·¯æ–°é—»æœç´¢å¼•æ“ã€‚æ ¸å¿ƒæŒ‘æˆ˜åŒ…æ‹¬å¤§è§„æ¨¡æ•°æ®çš„åˆ†å¸ƒå¼é«˜æ•ˆé‡‡é›†ã€åŠ¨æ€ç½‘é¡µå†…å®¹å¤„ç†ã€åçˆ¬è™«ç­–ç•¥åº”å¯¹ã€é«˜æ€§èƒ½æ£€ç´¢å¼•æ“çš„æ„å»ºä¸ä¼˜åŒ–ã€ä»¥åŠç”¨æˆ·å‹å¥½çš„æœç´¢ä½“éªŒè®¾è®¡ã€‚

è¯¥é¡¹ç›®æ˜¯ä½œä¸ºâ€œç»¼åˆè¯¾è®¾IIâ€ç‹¬ç«‹å¼€å‘çš„ï¼Œå…¨é¢å±•ç¤ºäº†åœ¨æ•°æ®å·¥ç¨‹ã€åç«¯å¼€å‘å’Œæœç´¢æŠ€æœ¯æ–¹é¢çš„ç»¼åˆèƒ½åŠ›ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

*   **ğŸš€ é«˜æ•ˆåˆ†å¸ƒå¼çˆ¬è™«é›†ç¾¤ï¼š**
    *   åŸºäº Scrapy æ¡†æ¶æ„å»ºï¼Œæ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½² (Scrapyd)ã€‚
    *   é›†æˆ Selenium å¤„ç†åŠ¨æ€åŠ è½½å†…å®¹å’Œæ¨¡æ‹Ÿç™»å½•ç­‰åçˆ¬è™«åœºæ™¯ã€‚
    *   å®ç°é«˜æ•ˆæ•°æ®é‡‡é›†ï¼ˆä¾‹å¦‚ï¼Œ>10000ç¯‡æ–°é—»ï¼Œä¸‡é¡µ/10åˆ†é’Ÿçš„é‡‡é›†æ•ˆç‡ï¼‰ã€‚
*   **ğŸ” å¼ºå¤§çš„æ£€ç´¢å¼•æ“ï¼š**
    *   æ ¸å¿ƒé‡‡ç”¨ Elasticsearch æ„å»ºå€’æ’ç´¢å¼•ï¼Œæ”¯æŒæµ·é‡æ•°æ®å­˜å‚¨ä¸æ£€ç´¢ã€‚
    *   è‡ªå®šä¹‰ ES ç´¢å¼• (IK Analyzer) ä»¥ä¼˜åŒ–ä¸­æ–‡åˆ†è¯å’Œæ£€ç´¢æ•ˆæœã€‚
    *   å®ç°äºšç§’çº§å…¨æ–‡æ£€ç´¢ã€ç»“æœé«˜äº®ã€æ‹¼å†™çº é”™æç¤ºã€‚
*   **ğŸ’¡ æ™ºèƒ½æœç´¢ä½“éªŒï¼š**
    *   é›†æˆå®æ—¶æœç´¢å»ºè®® (ES Suggest)ã€‚
    *   å®ç°çƒ­é—¨æœç´¢æ’è¡Œ (Redis Sorted Set)ã€‚
    *   æ”¯æŒæœ¬åœ°æœç´¢å†å²è®°å½•ã€‚
*   **âš™ï¸ å®Œæ•´æ•°æ®é“¾è·¯ï¼š**
    *   æ„å»º ETL (Extract, Transform, Load) ç®¡é“ï¼Œæå‡æ•°æ®è´¨é‡ã€‚
    *   æ•°æ®ä»é‡‡é›†ã€æ¸…æ´—ã€ç»“æ„åŒ–åˆ°ç´¢å¼•çš„å…¨æµç¨‹ç®¡ç†ã€‚
*   **ğŸ–¥ï¸ ç”¨æˆ·å‹å¥½çš„å‰åç«¯ï¼š**
    *   åç«¯é‡‡ç”¨ Django (MVT) æ¡†æ¶æä¾›æ ¸å¿ƒ API æœåŠ¡ã€‚
    *   å‰ç«¯ä½¿ç”¨ HTML5, CSS3, JavaScript, jQuery, AJAX æ„å»ºåŠ¨æ€äº¤äº’ç•Œé¢ã€‚
*   **ğŸ“Š ç³»ç»Ÿéƒ¨ç½²ä¸ç›‘æ§ï¼š**
    *   åˆ©ç”¨ Scrapyd å®ç°çˆ¬è™«çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ä¸è°ƒåº¦ã€‚
    *   ç»“åˆ Kibana è¿›è¡Œæ•°æ®å¯è§†åŒ–åˆ†æåŠç³»ç»Ÿæ€§èƒ½ç›‘æ§ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

*   **åç«¯ (Backend)ï¼š**
    *   Python 3.10
    *   Django (MVT)
    *   Scrapy (åˆ†å¸ƒå¼çˆ¬è™«æ¡†æ¶)
    *   Elasticsearch (DSL, IK Analyzer) - æ£€ç´¢å¼•æ“
    *   Redis (ç¼“å­˜, çƒ­é—¨æ’è¡Œ)
*   **å‰ç«¯ (Frontend)ï¼š**
    *   HTML5, CSS3
    *   JavaScript, jQuery, AJAX
*   **çˆ¬è™«ä¸æ•°æ®å¤„ç† (Crawling & Data Processing)ï¼š**
    *   Selenium (å¤„ç†åŠ¨æ€ç½‘é¡µ)
*   **éƒ¨ç½²ä¸ç›‘æ§ (Deployment & Monitoring)ï¼š**
    *   Scrapyd (Scrapy éƒ¨ç½²ä¸è°ƒåº¦)
    *   Kibana (æ•°æ®å¯è§†åŒ–ä¸ç›‘æ§)
*   **å¼€å‘å·¥å…· (Key Tools)ï¼š**
    *   PyCharm, Navicat

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

ç³»ç»Ÿä¸»è¦ç”±ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ç»„æˆï¼š

1.  **æ•°æ®é‡‡é›†å±‚ (Data Collection Layer)ï¼š**
    *   åŸºäº Scrapy çš„åˆ†å¸ƒå¼çˆ¬è™«é›†ç¾¤ã€‚
    *   é€šè¿‡ Scrapyd è¿›è¡Œç®¡ç†å’Œè°ƒåº¦ã€‚
    *   ä½¿ç”¨ Selenium è¾…åŠ©å¤„ç†åŠ¨æ€å†…å®¹ã€‚
2.  **æ•°æ®å¤„ç†ä¸å­˜å‚¨å±‚ (Data Processing & Storage Layer)ï¼š**
    *   ETL ç®¡é“å¯¹åŸå§‹æ•°æ®è¿›è¡Œæ¸…æ´—ã€è½¬æ¢å’Œç»“æ„åŒ–ã€‚
    *   åŸå§‹æ•°æ®æˆ–ä¸­é—´æ•°æ®å¯æš‚å­˜ï¼ˆä¾‹å¦‚ï¼Œæ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚
3.  **ç´¢å¼•ä¸æ£€ç´¢å±‚ (Indexing & Search Layer)ï¼š**
    *   Elasticsearch ä½œä¸ºæ ¸å¿ƒæ£€ç´¢å¼•æ“ï¼Œæ„å»ºå€’æ’ç´¢å¼•ã€‚
    *   IK Analyzer ç”¨äºä¸­æ–‡åˆ†è¯ä¼˜åŒ–ã€‚
    *   Redis ç”¨äºå­˜å‚¨çƒ­é—¨æœç´¢ã€æœç´¢å»ºè®®ç­‰è¾…åŠ©æ•°æ®ã€‚
4.  **åº”ç”¨æœåŠ¡å±‚ (Application Service Layer)ï¼š**
    *   Django (MVT) æ¡†æ¶æä¾›åç«¯ API æ¥å£ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘ã€‚
5.  **ç”¨æˆ·äº¤äº’å±‚ (User Interaction Layer)ï¼š**
    *   HTML/CSS/JS æ„å»ºçš„å‰ç«¯ç•Œé¢ï¼Œä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œå±•ç¤ºæœç´¢ç»“æœã€‚
6.  **ç›‘æ§ä¸ç®¡ç†å±‚ (Monitoring & Management Layer)ï¼š**
    *   Kibana å¯¹ Elasticsearch ä¸­çš„æ•°æ®è¿›è¡Œå¯è§†åŒ–åˆ†æå’Œç›‘æ§ã€‚
    *   Scrapyd Web UI ç›‘æ§çˆ¬è™«çŠ¶æ€ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚ (Prerequisites)

*   Python 3.10
*   Scrapy
*   Django
*   Elasticsearch 
*   IK Analyzer for Elasticsearch
*   Redis
*   Selenium åŠå¯¹åº”æµè§ˆå™¨é©±åŠ¨
*   Node.js å’Œ npm
*   Scrapyd

### å®‰è£…æ­¥éª¤ (Installation)

1.  **å…‹éš†ä»“åº“ï¼š**
    ```bash
    git clone https://github.com/ä½ çš„ç”¨æˆ·å/ä½ çš„æœç´¢å¼•æ“ä»“åº“å.git
    cd ä½ çš„æœç´¢å¼•æ“ä»“åº“å
    ```

2.  **åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ (æ¨è)ï¼š**
    ```bash
    python -m venv venv
    source venv/bin/activate  # Windows ç³»ç»Ÿ: venv\Scripts\activate
    ```

3.  **å®‰è£… Python ä¾èµ–ï¼š**
    ```bash
    pip install -r requirements.txt
    ```
    (ç¡®ä¿ `requirements.txt` æ–‡ä»¶åŒ…å«äº†æ‰€æœ‰å¿…è¦çš„ Python åŒ…)

4.  **å®‰è£… Elasticsearch å’Œ IK Analyzerï¼š**
    *   è¯·å‚ç…§ Elasticsearch å®˜æ–¹æ–‡æ¡£å®‰è£… Elasticsearchã€‚
    *   ä¸‹è½½ä¸æ‚¨ Elasticsearch ç‰ˆæœ¬å¯¹åº”çš„ IK Analyzer æ’ä»¶ï¼Œå¹¶è§£å‹åˆ° Elasticsearch çš„ `plugins` ç›®å½•ä¸‹ï¼Œé‡å¯ Elasticsearchã€‚

5.  **å®‰è£… Redisï¼š**
    *   è¯·å‚ç…§ Redis å®˜æ–¹æ–‡æ¡£è¿›è¡Œå®‰è£…ã€‚

6.  **é…ç½®é¡¹ç›®ï¼š**
    *   **Django è®¾ç½®ï¼š** ä¿®æ”¹ `your_project_name/settings.py` (é€šå¸¸æ˜¯ `settings.py`) ä¸­çš„æ•°æ®åº“é…ç½® (å¦‚æœé™¤äº† ES å’Œ Redis ä¹‹å¤–è¿˜ç”¨äº†å…³ç³»å‹æ•°æ®åº“)ã€Elasticsearch è¿æ¥ä¿¡æ¯ã€Redis è¿æ¥ä¿¡æ¯ç­‰ã€‚
    *   **Scrapy è®¾ç½®ï¼š** æ£€æŸ¥ Scrapy é¡¹ç›® (`scrapy_project_name/settings.py`) ä¸­çš„ pipeline é…ç½®ï¼Œç¡®ä¿æ•°æ®èƒ½æ­£ç¡®å†™å…¥ Elasticsearchã€‚
    *   å¯èƒ½éœ€è¦åˆ›å»º `.env` æ–‡ä»¶æ¥ç®¡ç†æ•æ„Ÿé…ç½®ä¿¡æ¯ï¼Œå¹¶ç›¸åº”ä¿®æ”¹ `settings.py` è¯»å–è¿™äº›é…ç½®ã€‚

### è¿è¡Œåº”ç”¨ (Running the Application)

1.  **å¯åŠ¨ Elasticsearch å’Œ Redis æœåŠ¡ã€‚**

2.  **è¿è¡Œæ•°æ®åº“è¿ç§» (å¦‚æœä½¿ç”¨ Django ORM å’Œå…³ç³»å‹æ•°æ®åº“)ï¼š**
    ```bash
    python manage.py makemigrations
    python manage.py migrate
    ```

3.  **å¯åŠ¨ Django å¼€å‘æœåŠ¡å™¨ï¼š**
    ```bash
    python manage.py runserver
    ```
    åº”ç”¨é€šå¸¸å¯ä»¥åœ¨ `http://127.0.0.1:8000/` è®¿é—®ã€‚

4.  **è¿è¡Œ Scrapy çˆ¬è™«ï¼š**
    è¿›å…¥ Scrapy é¡¹ç›®ç›®å½• (`cd scrapy_project_name`):
    ```bash
    scrapy crawl your_spider_name
    ```
    æˆ–è€…é€šè¿‡ Scrapyd è¿›è¡Œéƒ¨ç½²å’Œè°ƒåº¦ã€‚

## ğŸ® ä½¿ç”¨è¯´æ˜ (Usage)

*   æ‰“å¼€æµè§ˆå™¨è®¿é—® Django åº”ç”¨çš„é¦–é¡µ (é€šå¸¸æ˜¯ `http://127.0.0.1:8000/`)ã€‚
*   åœ¨æœç´¢æ¡†ä¸­è¾“å…¥å…³é”®è¯è¿›è¡Œæ–°é—»æ£€ç´¢ã€‚
*   ä½“éªŒæœç´¢å»ºè®®ã€çƒ­é—¨æ’è¡Œç­‰åŠŸèƒ½ã€‚

<!-- ## ğŸ“ é¡¹ç›®ç»“æ„ (å¯é€‰, ä½†å¾ˆæœ‰å¸®åŠ©)
